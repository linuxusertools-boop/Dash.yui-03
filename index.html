<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YUI 03 | NEURAL CONTROL CENTER</title>
    
    <script src="https://js.puter.com/v2/"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Orbitron:wght@400;700;900&display=swap');

        :root {
            --primary: #00f2ff;
            --success: #00ffaa;
            --danger: #ff0055;
            --bg: #010206;
            --border: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
        body { 
            background: var(--bg); color: #ececec; 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            overflow-x: hidden;
            background-image: radial-gradient(circle at 50% 50%, #0a0c1a 0%, #010206 100%);
            height: 100vh;
        }

        /* Screens */
        #entry-overlay, #login-overlay, #intro-screen { position: fixed; inset: 0; z-index: 3000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; }
        #entry-overlay { background: #000; }
        #login-overlay { display: none; background: rgba(0,0,0,0.97); backdrop-filter: blur(20px); }
        #intro-screen { display: none; background: #000; }

        .power-btn { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--primary); cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 30px rgba(0, 242, 255, 0.2); }
        
        .login-box { width: 350px; padding: 40px; border: 1px solid var(--border); background: rgba(255,255,255,0.03); border-radius: 30px; text-align: center; }
        .input-std { width: 100%; padding: 14px; background: rgba(255,255,255,0.07); border: 1px solid var(--border); border-radius: 12px; color: #fff; font-size: 13px; margin-bottom: 15px; }

        #dashboard { display: none; padding: 20px; opacity: 0; transition: 1.5s; max-width: 850px; margin: 0 auto; }
        #dashboard.active { display: block; opacity: 1; }

        .admin-card { border: 1px solid var(--success); padding: 20px; border-radius: 20px; background: rgba(0,255,170,0.02); margin-bottom: 30px; }
        .update-box { border: 1px solid var(--primary); border-radius: 25px; padding: 25px; background: rgba(0, 242, 255, 0.03); }
        .file-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; margin-bottom: 10px; border: 1px solid var(--border); }
        
        .btn-main { width: 100%; padding: 15px; border-radius: 12px; font-family: 'Orbitron'; font-size: 10px; cursor: pointer; border: none; font-weight: bold; }
        .btn-download { background: var(--primary); color: #000; padding: 8px 15px; border-radius: 8px; text-decoration: none; font-size: 10px; font-family: 'Orbitron'; font-weight: bold; }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
    </style>
</head>
<body>

    <div id="entry-overlay">
        <div class="power-btn" onclick="showLogin()">
            <div style="width:4px; height:20px; background:var(--primary); border-radius:2px;"></div>
        </div>
        <p style="margin-top:20px; font-family:'Orbitron'; font-size:10px; color:var(--primary); letter-spacing:5px;">SYSTEM STANDBY</p>
    </div>

    <div id="login-overlay">
        <div class="login-box" id="lbox">
            <h2 style="font-family:'Orbitron'; font-size:13px; color:var(--primary); margin-bottom:25px;">NEURAL ACCESS</h2>
            <input type="text" id="userIn" class="input-std" placeholder="Identity" autocomplete="off">
            <input type="password" id="passIn" class="input-std" placeholder="Security Code" autocomplete="off">
            <button onclick="handleLogin()" class="btn-main" style="background:var(--primary); color:#000;">INITIALIZE SYNC</button>
            <div id="login-err" style="color:var(--danger); font-size:9px; margin-top:15px; font-family:monospace;"></div>
        </div>
    </div>

    <div id="intro-screen">
        <p style="font-family:'Orbitron'; font-size:10px; color:var(--primary); letter-spacing:4px;">ESTABLISHING CLOUD LINK...</p>
    </div>

    <main id="dashboard">
        <nav style="display:flex; justify-content:space-between; padding:20px 0; font-family:'Orbitron'; font-size:8px; border-bottom:1px solid var(--border); margin-bottom:30px;">
            <div>CORE: <span id="role-tag" style="color:var(--primary)">ACTIVE</span></div>
            <div id="clock">00:00:00</div>
        </nav>

        <section id="admin-panel" style="display:none;" class="admin-card">
            <p style="color:var(--success); font-family:'Orbitron'; font-size:10px; margin-bottom:15px;">ADMIN DEPLOYMENT CENTER</p>
            <input type="text" id="upDesc" class="input-std" placeholder="Update Description">
            <input type="file" id="upFile" class="input-std">
            <button id="pushBtn" onclick="pushUpdate()" class="btn-main" style="background:var(--success); color:#000;">PUSH TO GLOBAL STREAM</button>
        </section>

        <h1 style="font-family:'Orbitron'; font-size:2rem; margin-bottom:10px;">YUI ¤ 03</h1>
        <div style="height:2px; width:50px; background:var(--primary); margin-bottom:40px;"></div>

        <div class="update-box">
            <p style="font-family:'Orbitron'; font-size:11px; margin-bottom:20px; color:var(--primary);">GLOBAL UPDATE STREAM</p>
            <div id="file-list">
                <p style="text-align:center; opacity:0.3; font-size:10px;">Awaiting neural data...</p>
            </div>
        </div>
    </main>

    <script>
        const PUTER_DIR = "yui_neural_public";
        let isSystemAdmin = false;

        // --- DATA LOGIN (DIPERBAIKI) ---
        const CREDENTIALS = {
            user: "admin@kev.soft",
            pass: "kevin@admin#update+console/kev.com"
        };

        function showLogin() {
            document.getElementById('entry-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('entry-overlay').style.display = 'none';
                document.getElementById('login-overlay').style.display = 'flex';
            }, 800);
        }

        async function handleLogin() {
            const u = document.getElementById('userIn').value.trim();
            const p = document.getElementById('passIn').value.trim();
            const errDisplay = document.getElementById('login-err');

            // Cek Admin
            if (u === CREDENTIALS.user && p === CREDENTIALS.pass) {
                isSystemAdmin = true;
                document.getElementById('role-tag').innerText = "ADMIN-CORE";
                document.getElementById('admin-panel').style.display = "block";
                
                // Login Puter hanya untuk Admin agar bisa tulis data
                if (!puter.auth.isSignedIn()) {
                    alert("Admin detected. Selesaikan login Puter untuk sinkronisasi cloud.");
                    await puter.auth.signIn();
                }
                await puter.directory.create(PUTER_DIR).catch(()=>{});
                proceedToDashboard();
            } 
            // Cek User Biasa
            else if (u === "user" && p === "user") {
                isSystemAdmin = false;
                document.getElementById('role-tag').innerText = "GUEST-LINK";
                proceedToDashboard();
            } 
            else {
                document.getElementById('lbox').style.animation = "shake 0.4s";
                errDisplay.innerText = "ERROR: INVALID IDENTITY OR SECURITY CODE";
                setTimeout(() => document.getElementById('lbox').style.animation = "", 400);
            }
        }

        function proceedToDashboard() {
            document.getElementById('login-overlay').style.opacity = '0';
            document.getElementById('intro-screen').style.display = 'flex';
            
            fetchGlobalUpdates();

            setTimeout(() => {
                document.getElementById('intro-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('intro-screen').style.display = 'none';
                    document.getElementById('dashboard').classList.add('active');
                }, 800);
            }, 3000);
        }

        // --- CLOUD LOGIC ---

        async function pushUpdate() {
            const file = document.getElementById('upFile').files[0];
            const desc = document.getElementById('upDesc').value;
            const btn = document.getElementById('pushBtn');

            if(!file || !desc) return alert("Pilih file & isi deskripsi!");

            btn.innerText = "DEPLOYING TO CLOUD...";
            btn.disabled = true;

            try {
                const path = `${PUTER_DIR}/${file.name}`;
                // 1. Upload
                await puter.fs.write(path, file);
                // 2. Set Public (Sangat Penting!)
                const pubFile = await puter.fs.makePublic(path);

                // 3. Update Meta
                let meta = [];
                try {
                    const res = await puter.fs.read(`${PUTER_DIR}/meta.json`);
                    meta = JSON.parse(await res.text());
                } catch(e) {}

                meta.unshift({
                    name: file.name,
                    desc: desc,
                    url: pubFile.url,
                    date: new Date().toLocaleDateString()
                });

                await puter.fs.write(`${PUTER_DIR}/meta.json`, JSON.stringify(meta));
                await puter.fs.makePublic(`${PUTER_DIR}/meta.json`);

                alert("DEPLOY SUCCESS: Semua perangkat telah tersinkronisasi.");
                location.reload();
            } catch (err) {
                alert("Cloud Sync Error: " + err.message);
                btn.disabled = false;
                btn.innerText = "PUSH TO GLOBAL STREAM";
            }
        }

        async function fetchGlobalUpdates() {
            const list = document.getElementById('file-list');
            try {
                // User guest membaca file meta.json yang sudah dibuat publik oleh admin
                const res = await puter.fs.read(`${PUTER_DIR}/meta.json`);
                const data = JSON.parse(await res.text());

                if (data.length === 0) throw new Error();

                list.innerHTML = "";
                data.forEach(item => {
                    list.innerHTML += `
                        <div class="file-item">
                            <div>
                                <p style="font-family:'Orbitron'; font-size:11px; color:var(--primary);">${item.name}</p>
                                <p style="font-size:9px; opacity:0.6; margin-top:4px;">${item.desc} • ${item.date}</p>
                            </div>
                            <a href="${item.url}" target="_blank" class="btn-download">DOWNLOAD</a>
                        </div>`;
                });
            } catch (e) {
                list.innerHTML = `<p style="text-align:center; opacity:0.3; font-size:10px;">No public updates available.</p>`;
            }
        }

        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }, 1000);
    </script>
</body>
</html>
